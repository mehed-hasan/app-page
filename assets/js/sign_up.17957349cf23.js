$('.sign-up-second-step').hide();function get_query_param(key){var URL_QUERY_PARAMS=new URLSearchParams(window.location.search);return URL_QUERY_PARAMS.get(key);}
jQuery(document).ready(function(e){var countInterval;var phone_number;var pre_counter_text='<i class="far fa-clock" aria-hidden="true"></i>&nbsp;00:';$(document).on('click','.arrow-signup',function(e){$(".sign-up-second-step").hide();$(".sign-up-first-step").show();$("#count").html(pre_counter_text+"30");if(countInterval!==false){clearInterval(countInterval);countInterval=false;}});$(document).on('click','#btnCounter',function(e){e.preventDefault();$("#btnCounterDisabled").css("display","inline-block");$("#btnCounter").css("display","none");$("#count").css('display','inline-block');$("#otp-generate").submit();});jQuery.validator.addMethod("itiValidNumberSignup",function(value,element){return this.optional(element)||ITI_ALL.isValidNumber();},"Please enter a valid  Phone Number");$("#otp-generate").validate({rules:{phone:{required:true,number:true,itiValidNumberSignup:true,}},messages:{phone:{required:"Mobile number is required",number:"Please enter number only",}},submitHandler:function(form){phone_number=ITI_ALL.getNumber();if(phone_number){start_full_loader();$.ajax({type:"post",url:send_otp_url,data:{'csrfmiddlewaretoken':$('#global-csrf-token').val(),'phone_number':phone_number.replace("+",""),'country_iso2_code':ITI_ALL.getSelectedCountryData().iso2,},dataType:'json',success:function(data,status){stop_full_loader();if(data.status=="exist"){var html="You are already registered. If you forgot your password please try <a style='color: red; text-decoration: underline' href="+forgot_password_url+"> Recover Password</a>";$('#error-message-step-1 h6').css('color','red').css('margin-top','15px').html(html);$('#error-message-step-1').show();}
else if(data.smsStatus=="MESSAGE_SENT"){$('#message-sent-phone-no').html('<b>'+phone_number+'</b>');$('.sign-up-first-step').hide();$('.sign-up-second-step').show();$("#pinId").val(data.pinId);$("#count").show();var counter=30;countInterval=setInterval(function(){--counter;if(counter>=0){var extra_zero="";if(counter<10){extra_zero="0";}
$("#count").html(pre_counter_text+extra_zero+counter);}
else{$("#btnCounterDisabled").hide();$("#btnCounter").css("display","inline").css("text-transform","none");$("#count").hide();clearInterval(countInterval);countInterval=false;$("#count").html(pre_counter_text+"30");}},1000);}
else{alert("something went wrong!")}},error:function(xhr,desc,err){stop_full_loader();}});}},unhighlight:function(element,errorClass,validClass){$(element).next('label.error').remove();},errorPlacement:function(error,element){element.after(error);}});$("#otp-submit").validate({rules:{otp:{required:true,number:true},password:{required:true,minlength:8},confirm_password:{required:true,minlength:8,equalTo:"#password"}},submitHandler:function(form){if(ITI_ALL.selectedCountryData.iso2!==undefined){var country_iso2_code=ITI_ALL.selectedCountryData.iso2;var phone_country_code=ITI_ALL.selectedCountryData.dialCode;var phone_no=ITI_ALL.getNumber().replace("+"+ITI_ALL.selectedCountryData.dialCode,"");var name=$('#customer-name').val();var password=$('#password').val();var otp_code=$('#otp').val();var otp_secret=$('#pinId').val();if(country_iso2_code&&phone_country_code&&phone_no&&name&&password&&otp_code&&otp_secret){start_full_loader();$.ajax({type:"POST",url:submit_otp_url,data:{csrfmiddlewaretoken:$('#global-csrf-token').val(),country_iso2_code:country_iso2_code,phone_country_code:phone_country_code,phone_no:phone_no,name:name,password:password,otp_code:otp_code,otp_secret:otp_secret,},dataType:'json',success:function(data,status){stop_full_loader();if(data.status){$("#error-message-step-2 h5").css('color','green').html("Your account has been created.");$("#error-message-step-2").show();var ref_url=get_query_param('ref');if(ref_url){location.replace(location.origin+'/'+ref_url);}
else{location.replace(location.origin+profile_url);}}
else{if(data.errorType=="wrong_otp_code"){$("#error-message-step-2 h5").css('color','red').html("You have entered wrong OTP. Please try again.");$("#error-message-step-2").show();}
else{$("#error-message-step-2 h5").css('color','red').html("An error occured");$("#error-message-step-2").show();}}},error:function(xhr,desc,err){stop_full_loader();}});}}},unhighlight:function(element,errorClass,validClass){$(element).next('label.error').remove();},errorPlacement:function(error,element){element.after(error);}});});;