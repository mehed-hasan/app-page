jQuery(document).ready(function(){$(document).on("click",'[data-quantity="cart_plus"]',function(e){e.preventDefault();var product_id=parseInt($(this).attr("data-product_id"));var qty_avail=parseInt($(this).attr("data-qty_avail"));fieldName=$(this).attr('data-field');var currentVal=parseInt($("#"+fieldName).text());if(!isNaN(currentVal)){if(currentVal<qty_avail){currentVal=currentVal+1;$("#"+fieldName).text(currentVal);cartManage(product_id,currentVal);$(this).attr("disabled",false);$("#minus-btn-"+product_id).attr("disabled",false);$('#menu_cart_minus_btn-'+product_id).attr("disabled",false);}
if(currentVal>=qty_avail){$(this).attr("disabled",true);}}
else{$("#"+fieldName).text('1');cartManage(product_id,currentVal);$(this).attr("disabled",true);$("#minus-btn-"+product_id).attr("disabled",true);$('#menu_cart_minus_btn-'+product_id).attr("disabled",true);}});$(document).on('click','[data-quantity="cart_minus"]',function(e){e.preventDefault();var product_id=parseInt($(this).attr("data-product_id"));var qty_avail=parseInt($(this).attr("data-qty_avail"));fieldName=$(this).attr('data-field');var currentVal=parseInt($("#"+fieldName).text());if(!isNaN(currentVal)){if(currentVal>1){currentVal=currentVal-1;$("#"+fieldName).text(currentVal);cartManage(product_id,currentVal);$(this).attr("disabled",false);$("#plus-btn-"+product_id).attr("disabled",false);$('#menu_cart_plus_btn-'+product_id).attr("disabled",false);}
if(currentVal<=1){$(this).attr("disabled",true);}}
else{$("#"+fieldName).text('1');cartManage(product_id,1);}});$(document).on("click",".cart-item-remove",function(e){var obj=$(this);var product_id=obj.attr('data-product_id');if(product_id!=""&&product_id!=undefined){$.ajax({type:"GET",url:update_cart_ajax_url,data:{action:"remove",data:JSON.stringify({"product_id":product_id,}),},dataType:'json',success:function(data,status){if(status=="success"){obj.closest(".single-cart-item").remove();var updatedItemPrice=0;var updatedSubTotalPrice=0;var itemCount=0;var totalItemQty=0;$.each(data.cart_data,function(index,item){updatedSubTotalPrice+=parseInt(item['quantity'])*parseInt(item['price']);totalItemQty+=parseInt(item['quantity']);itemCount++;});updatedSubTotalPrice="BDT "+Number(updatedSubTotalPrice).toLocaleString('en');updateCartPrices(product_id,updatedItemPrice,updatedSubTotalPrice);$("#shopping_cart_btn span, #shopping_cart_btn_mobile span").text(totalItemQty);if(itemCount<1){$("#cart_checkout_btn_link").css("display","none");$("#cart_details_items_header").css("display","none");$("#cart_details_items").css("display","none");$("#cart_details_no_product_msg").css("display","block");}
$("#shopping-bag-title").text("Shopping Bag ("+totalItemQty+")");if(totalItemQty<1){$('.checkout-btn').prop('disabled',true);}
else{$('.checkout-btn').prop('disabled',false);}
if(itemCount<1){$(".menu_cart_item_div").css("display","none");$("#menu_cart_details_no_product_msg").css("display","block");}}},error:function(xhr,desc,err){console.log(err);},});}});$(document).on("click",".cart-item-remove-mobile",function(e){var obj=$(this);var product_id=obj.attr('data-product_id');if(product_id!=""&&product_id!=undefined){$.ajax({type:"GET",url:update_cart_ajax_url,data:{action:"remove",data:JSON.stringify({"product_id":product_id,}),},dataType:'json',success:function(data,status){if(status=="success"){obj.closest(".single-cart-item").remove();var updatedItemPrice=0;var updatedSubTotalPrice=0;var itemCount=0;var totalItemQty=0;$.each(data.cart_data,function(index,item){updatedSubTotalPrice+=parseInt(item['quantity'])*parseInt(item['price']);totalItemQty+=parseInt(item['quantity']);itemCount++;});updatedSubTotalPrice="BDT "+Number(updatedSubTotalPrice).toLocaleString('en');updateCartPrices(product_id,updatedItemPrice,updatedSubTotalPrice);$("#shopping_cart_btn span, #shopping_cart_btn_mobile span").text(totalItemQty);if(itemCount<1){$("#cart_checkout_btn_link").css("display","none");$("#cart_details_items_header").css("display","none");$("#cart_details_items").css("display","none");$("#cart_details_no_product_msg").css("display","block");}}},error:function(xhr,desc,err){console.log(err);},});}});});function cartManage(product_id,qty){if(product_id!=""&&product_id!=undefined&&qty!=""&&qty!=undefined){$.ajax({type:"GET",url:update_cart_ajax_url,data:{action:"update",data:JSON.stringify({"product_id":product_id,"quantity":qty,}),},dataType:'json',success:function(data,status){if(status=="success"){var updatedItemPrice="BDT "+Number(parseInt(data.cart_data[product_id]['quantity'])*data.cart_data[product_id]['price']).toLocaleString('en');var updatedSubTotalPrice=0;var totalItemQty=0;$.each(data.cart_data,function(index,item){updatedSubTotalPrice+=parseInt(item['quantity'])*parseInt(item['price']);totalItemQty+=parseInt(item['quantity']);});updatedSubTotalPrice="BDT "+Number(updatedSubTotalPrice).toLocaleString('en');updateCartPrices(product_id,updatedItemPrice,updatedSubTotalPrice);$("#shopping_cart_btn span, #shopping_cart_btn_mobile span").text(totalItemQty);$("#shopping-bag-title").text("Shopping Bag ("+totalItemQty+")");if(totalItemQty<1){$('.checkout-btn').prop('disabled',true);}
else{$('.checkout-btn').prop('disabled',false);}}},error:function(xhr,desc,err){console.log(err);},});}}
function updateCartPrices(product_id,updatedItemPrice,updatedSubTotalPrice){if($("#item_price_"+product_id)!=undefined){$("#item_price_"+product_id).html(updatedItemPrice);}
$("#sub_total_price").html(updatedSubTotalPrice);$("#total_price").html(updatedSubTotalPrice);if($("#menu_cart_item_price_"+product_id)!=undefined){$("#menu_cart_item_price_"+product_id).html(updatedItemPrice);}
$("#menu_cart_total_price").html('<p>Subtotal: '+updatedSubTotalPrice+'</p>');};